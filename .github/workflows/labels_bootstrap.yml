name: Bootstrap labels

on:
  workflow_dispatch:

permissions:
  issues: write

jobs:
  create-labels:
    runs-on: ubuntu-latest
    steps:
      - name: Ensure labels exist
        uses: actions/github-script@v7
        with:
          script: |
            const required = [
              { name: 'daily', color: '1d76db', description: 'Growth daily journal' },
              { name: 'weekly', color: '5319e7', description: 'Weekly review' },
              { name: 'milton', color: 'f4b400', description: 'Milton practice' },
              { name: 'practice', color: '34d058', description: 'Practice sessions' }
            ];

            const { owner, repo } = context.repo;
            const existing = await github.paginate(github.rest.issues.listLabelsForRepo, { owner, repo, per_page: 100 });

            for (const label of required) {
              const found = existing.find((item) => item.name.toLowerCase() === label.name.toLowerCase());
              if (found) {
                core.info(`Label ${label.name} already exists`);
                continue;
              }

              await github.rest.issues.createLabel({
                owner,
                repo,
                name: label.name,
                color: label.color,
                description: label.description
              });
              core.info(`Created label ${label.name}`);
            }
